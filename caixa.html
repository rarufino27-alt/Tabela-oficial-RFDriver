<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Livro Caixa ‚Äì RF Driver</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#f4f7fb;
  --blue:#0b2238;
  --blue-soft:#12355b;
  --gold:#d4af37;
  --gold-light:#e6c97a;
  --green:#1db954;
  --red:#d9534f;
  --card:#ffffff;
  --border:#dce3ed;
  --text:#0b1b2b;
}

*{box-sizing:border-box;font-family:Inter,system-ui,Arial}

body{
  margin:0;
  background:linear-gradient(180deg,#ffffff,var(--bg));
  color:var(--text);
  padding:20px;
}

.container{
  max-width:420px;
  margin:auto;
  display:flex;
  flex-direction:column;
  gap:16px;
}

.header{
  background:linear-gradient(180deg,var(--blue),var(--blue-soft));
  color:#fff;
  border-radius:22px;
  padding:20px;
  text-align:center;
}

.header h1{
  margin:0;
  font-size:1.4rem;
  background:linear-gradient(120deg,var(--gold),var(--gold-light),var(--gold));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}

.saldo{
  background:#fff;
  border-radius:20px;
  padding:16px;
  text-align:center;
}

.saldo strong{
  font-size:2rem;
  color:var(--gold);
}

.tabs{display:flex;gap:8px}
.tabs button{
  flex:1;padding:12px;border-radius:14px;border:1px solid var(--border);
  background:#fff;font-weight:700
}
.tabs button.active{
  background:linear-gradient(145deg,var(--gold-light),var(--gold));
}

.card{
  background:#fff;border-radius:18px;padding:16px;
}

input,select{width:100%;padding:12px;margin-bottom:8px;border-radius:14px;border:1px solid var(--border)}

.btn{padding:12px;border:none;border-radius:14px;font-weight:700;width:100%}
.btn-green{background:var(--green);color:#fff}
.btn-red{background:var(--red);color:#fff}
.btn-gold{background:linear-gradient(145deg,var(--gold-light),var(--gold))}

.item{
  display:flex;justify-content:space-between;align-items:center;
  font-size:.85rem;margin-bottom:6px
}
.item-actions button{
  margin-left:6px;font-size:.7rem
}

.history-day{
  border-top:1px solid var(--border);
  padding-top:10px;margin-top:10px
}
</style>
</head>

<body>

<div class="container">

  <div class="header">
    <h1>LIVRO CAIXA</h1>
    <small>RF Driver</small>
  </div>

  <div class="saldo">
    Saldo do dia
    <strong id="saldo">R$ 0,00</strong>
  </div>

  <div class="tabs">
    <button class="active" onclick="abrirTab('corridas',this)">Corridas</button>
    <button onclick="abrirTab('entradas',this)">Entradas</button>
    <button onclick="abrirTab('saidas',this)">Sa√≠das</button>
    <button onclick="abrirTab('resumo',this)">Resumo</button>
  </div>

  <!-- CORRIDAS -->
  <div class="card tab corridas">
    <select id="tipoCorrida">
      <option>GRUPO RF DRIVER</option>
      <option>Aplicativo</option>
      <option>Particular</option>
      <option>Empresa</option>
    </select>
    <input id="detalhe" placeholder="Detalhe opcional">
    <input type="number" id="valorCorrida" placeholder="Valor">
    <button class="btn btn-green" onclick="add('entrada','Corrida',valorCorrida.value)">Registrar</button>
  </div>

  <!-- ENTRADAS -->
  <div class="card tab entradas" style="display:none">
    <input id="descEntrada" placeholder="Descri√ß√£o">
    <input type="number" id="valorEntrada" placeholder="Valor">
    <button class="btn btn-green" onclick="add('entrada',descEntrada.value,valorEntrada.value)">Registrar</button>
  </div>

  <!-- SA√çDAS -->
  <div class="card tab saidas" style="display:none">
    <input id="descSaida" placeholder="Descri√ß√£o">
    <input type="number" id="valorSaida" placeholder="Valor">
    <button class="btn btn-red" onclick="add('saida',descSaida.value,valorSaida.value)">Registrar</button>
  </div>

  <!-- RESUMO -->
  <div class="card tab resumo" style="display:none">
    <div id="lista"></div>
    <button class="btn btn-red" onclick="zerar()">Zerar Caixa</button>
    <button class="btn btn-gold" onclick="finalizar()">Finalizar Dia</button>
  </div>

  <!-- HIST√ìRICO -->
  <div class="card">
    <strong>Hist√≥rico (√∫ltimos 30 dias)</strong>
    <div id="historico"></div>
  </div>

</div>

<script>
const LS_ATUAL="rf_caixa_atual";
const LS_HIST="rf_caixa_historico";
let caixa = JSON.parse(localStorage.getItem(LS_ATUAL)) || [];
let hist = JSON.parse(localStorage.getItem(LS_HIST)) || [];

const moeda=v=>v.toLocaleString("pt-BR",{style:"currency",currency:"BRL"});

function salvar(){
  localStorage.setItem(LS_ATUAL,JSON.stringify(caixa));
  localStorage.setItem(LS_HIST,JSON.stringify(hist.slice(-30)));
}

function atualizar(){
  let total=0,html="";
  caixa.forEach((m,i)=>{
    total+=m.tipo==="entrada"?m.valor:-m.valor;
    html+=`
      <div class="item">
        <span>${m.desc} ‚Äì ${moeda(m.valor)}</span>
        <span class="item-actions">
          <button onclick="editar(${i})">‚úèÔ∏è</button>
          <button onclick="apagar(${i})">üóëÔ∏è</button>
        </span>
      </div>`;
  });
  saldo.innerText=moeda(total);
  lista.innerHTML=html;
  salvar();
}

function add(tipo,desc,valor){
  if(!desc||!valor) return;
  caixa.push({tipo,desc,valor:Number(valor)});
  atualizar();
}

function editar(i){
  const d=prompt("Descri√ß√£o",caixa[i].desc);
  const v=prompt("Valor",caixa[i].valor);
  if(d&&v){caixa[i]={...caixa[i],desc:d,valor:Number(v)};atualizar();}
}

function apagar(i){if(confirm("Apagar registro?")){caixa.splice(i,1);atualizar();}}

function zerar(){if(confirm("Zerar todos os registros do dia?")){caixa=[];atualizar();}}

function finalizar(){
  if(!caixa.length) return alert("Sem registros");
  hist.push({data:new Date().toLocaleDateString(),itens:caixa});
  caixa=[];
  atualizar();
  renderHist();
}

function renderHist(){
  historico.innerHTML="";
  hist.slice(-30).forEach((d,i)=>{
    historico.innerHTML+=`
      <div class="history-day">
        <strong>${d.data}</strong>
        <button onclick="whats(${i})">üì≤ WhatsApp</button>
      </div>`;
  });
}

function whats(i){
  let msg=`üìä RF Driver ‚Äì ${hist[i].data}\n\n`;
  hist[i].itens.forEach(m=>msg+=`${m.tipo==="entrada"?"‚ûï":"‚ûñ"} ${m.desc}: ${moeda(m.valor)}\n`);
  window.open("https://wa.me/?text="+encodeURIComponent(msg));
}

function abrirTab(tab,btn){
  document.querySelectorAll(".tab").forEach(t=>t.style.display="none");
  document.querySelectorAll(".tabs button").forEach(b=>b.classList.remove("active"));
  document.querySelector("."+tab).style.display="block";
  btn.classList.add("active");
}

renderHist();
atualizar();
</script>

</body>
</html>